<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Psychology Dataset Generator</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .lucide { width: 16px; height: 16px; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        // Simple icon components
        const Plus = () => <svg className="lucide" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M12 5v14M5 12h14"/></svg>;
        const Trash2 = () => <svg className="lucide" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M3 6h18M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/></svg>;
        const RefreshCw = () => <svg className="lucide" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M3 21v-5h5"/></svg>;
        const Eye = () => <svg className="lucide" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>;
        const EyeOff = () => <svg className="lucide" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94l0 0"/><path d="M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19l0 0"/><line x1="1" y1="1" x2="23" y2="23"/><path d="M14.12 14.12a3 3 0 1 1-4.24-4.24"/></svg>;
        const FileText = () => <svg className="lucide" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14,2 14,8 20,8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10,9 9,9 8,9"/></svg>;
        const FileSpreadsheet = () => <svg className="lucide" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14,2 14,8 20,8"/><line x1="8" y1="13" x2="16" y2="13"/><line x1="8" y1="17" x2="16" y2="17"/><line x1="12" y1="13" x2="12" y2="21"/></svg>;

        const PsychologyDatasetGenerator = () => {
          const [step, setStep] = useState(1);
          const [config, setConfig] = useState({
            description: '',
            sampleSize: 100,
            dataFormat: 'wide',
            targetAnalyses: [],
            variables: [],
            missingDataPercent: 0,
            includeOutliers: false
          });
          const [generatedData, setGeneratedData] = useState(null);
          const [showPreview, setShowPreview] = useState(false);

          const analysisOptions = [
            'Descriptive Statistics - Central Tendency & Variability',
            'Descriptive Statistics - Frequency Distributions',
            'Descriptive Statistics - Percentiles & Quartiles',
            'Descriptive Statistics - Distribution Shapes',
            'Single-Sample t-test',
            'Independent Samples t-test (Two-Group)',
            'Paired-Samples t-test (Dependent)',
            'Welch\'s t-test (Unequal Variances)',
            'One-Way ANOVA (Between-Subjects)',
            'One-Way Repeated Measures ANOVA',
            'Two-Way Factorial ANOVA',
            'Three-Way Factorial ANOVA',
            'Mixed-Design ANOVA (Split-Plot)',
            'Analysis of Covariance (ANCOVA)',
            'Multivariate ANOVA (MANOVA)',
            'Repeated Measures MANOVA',
            'Chi-Square Goodness of Fit',
            'Chi-Square Test of Independence',
            'Chi-Square Test of Homogeneity',
            'McNemar\'s Test (Paired Categorical)',
            'Pearson Product-Moment Correlation',
            'Spearman Rank Correlation',
            'Kendall\'s Tau Correlation',
            'Point-Biserial Correlation',
            'Phi Coefficient',
            'Simple Linear Regression',
            'Multiple Linear Regression',
            'Polynomial Regression',
            'Logistic Regression',
            'Hierarchical Regression',
            'Exploratory Factor Analysis (EFA)',
            'Confirmatory Factor Analysis (CFA)',
            'Principal Component Analysis (PCA)',
            'Cronbach\'s Alpha Reliability',
            'Split-Half Reliability',
            'Test-Retest Reliability',
            'Mann-Whitney U Test',
            'Wilcoxon Signed-Rank Test',
            'Kruskal-Wallis Test',
            'Friedman Test',
            'Sign Test',
            'Runs Test',
            'Kolmogorov-Smirnov Test',
            'Discriminant Function Analysis',
            'Canonical Correlation',
            'Survival Analysis (Kaplan-Meier)',
            'Time Series Analysis',
            'Multilevel/Hierarchical Linear Modeling',
            'Structural Equation Modeling (SEM)'
          ];

          const variableTypes = [
            { value: 'nominal', label: 'Nominal (Categorical)', example: 'Gender, Treatment Group' },
            { value: 'ordinal', label: 'Ordinal (Ranked)', example: 'Likert Scale, Education Level' },
            { value: 'interval', label: 'Interval (No true zero)', example: 'Temperature, IQ Score' },
            { value: 'ratio', label: 'Ratio (True zero)', example: 'Age, Response Time' }
          ];

          const distributionTypes = [
            { value: 'normal', label: 'Normal' },
            { value: 'skewed-right', label: 'Right Skewed' },
            { value: 'skewed-left', label: 'Left Skewed' },
            { value: 'bimodal', label: 'Bimodal' },
            { value: 'uniform', label: 'Uniform' }
          ];

          const addVariable = () => {
            const newVar = {
              id: Date.now(),
              name: '',
              type: 'ratio',
              distribution: 'normal',
              mean: 50,
              sd: 10,
              min: 0,
              max: 100,
              categories: ['Category 1', 'Category 2'],
              categoriesInput: 'Category 1, Category 2',
              correlateWith: null,
              correlationStrength: 0
            };
            setConfig(prev => ({
              ...prev,
              variables: [...prev.variables, newVar]
            }));
          };

          const updateVariable = (id, updates) => {
            setConfig(prev => ({
              ...prev,
              variables: prev.variables.map(v => v.id === id ? { ...v, ...updates } : v)
            }));
          };

          const removeVariable = (id) => {
            setConfig(prev => ({
              ...prev,
              variables: prev.variables.filter(v => v.id !== id)
            }));
          };

          const generateNormalData = (mean, sd, n) => {
            const data = [];
            for (let i = 0; i < n; i++) {
              let u = 0, v = 0;
              while(u === 0) u = Math.random();
              while(v === 0) v = Math.random();
              const z = Math.sqrt(-2.0 * Math.log(u)) * Math.cos(2 * Math.PI * v);
              data.push(mean + z * sd);
            }
            return data;
          };

          const generateSkewedData = (direction, mean, sd, n) => {
            const normal = generateNormalData(0, 1, n);
            const skewed = normal.map(x => {
              const transformed = direction === 'right' ? 
                Math.exp(x * 0.5) : 
                -Math.exp(-x * 0.5);
              return mean + transformed * sd;
            });
            return skewed;
          };

          const generateCategoricalData = (categories, n, weights = null) => {
            const data = [];
            const w = weights || categories.map(() => 1 / categories.length);
            
            for (let i = 0; i < n; i++) {
              const rand = Math.random();
              let sum = 0;
              for (let j = 0; j < categories.length; j++) {
                sum += w[j];
                if (rand <= sum) {
                  data.push(categories[j]);
                  break;
                }
              }
            }
            return data;
          };

          const generateDataset = () => {
            const n = config.sampleSize;
            const data = [];
            const variableData = {};

            const participantIds = Array.from({ length: n }, (_, i) => `P${String(i + 1).padStart(3, '0')}`);

            config.variables.forEach(variable => {
              let values = [];

              if (variable.type === 'nominal' || variable.type === 'ordinal') {
                values = generateCategoricalData(variable.categories, n);
              } else {
                switch (variable.distribution) {
                  case 'normal':
                    values = generateNormalData(variable.mean, variable.sd, n);
                    break;
                  case 'skewed-right':
                    values = generateSkewedData('right', variable.mean, variable.sd, n);
                    break;
                  case 'skewed-left':
                    values = generateSkewedData('left', variable.mean, variable.sd, n);
                    break;
                  case 'uniform':
                    values = Array.from({ length: n }, () => 
                      Math.random() * (variable.max - variable.min) + variable.min
                    );
                    break;
                  case 'bimodal':
                    const half = Math.floor(n / 2);
                    const group1 = generateNormalData(variable.mean - variable.sd, variable.sd / 2, half);
                    const group2 = generateNormalData(variable.mean + variable.sd, variable.sd / 2, n - half);
                    values = [...group1, ...group2].sort(() => Math.random() - 0.5);
                    break;
                }

                if (variable.type === 'interval' || variable.type === 'ratio') {
                  values = values.map(v => Math.max(variable.min, Math.min(variable.max, v)));
                }

                values = values.map(v => Math.round(v * 100) / 100);
              }

              variableData[variable.name] = values;
            });

            config.variables.forEach(variable => {
              if (variable.correlateWith && variable.correlationStrength !== 0) {
                const targetVar = variableData[variable.correlateWith];
                const currentVar = variableData[variable.name];
                
                if (targetVar && currentVar && 
                    (variable.type === 'interval' || variable.type === 'ratio')) {
                  
                  const correlation = variable.correlationStrength;
                  const newValues = currentVar.map((val, i) => {
                    const targetZ = (targetVar[i] - variable.mean) / variable.sd;
                    const currentZ = (val - variable.mean) / variable.sd;
                    const newZ = correlation * targetZ + Math.sqrt(1 - correlation * correlation) * currentZ;
                    return variable.mean + newZ * variable.sd;
                  });
                  
                  variableData[variable.name] = newValues.map(v => 
                    Math.max(variable.min, Math.min(variable.max, Math.round(v * 100) / 100))
                  );
                }
              }
            });

            if (config.missingDataPercent > 0) {
              config.variables.forEach(variable => {
                const values = variableData[variable.name];
                const missingCount = Math.floor(n * config.missingDataPercent / 100);
                const missingIndices = new Set();
                
                while (missingIndices.size < missingCount) {
                  missingIndices.add(Math.floor(Math.random() * n));
                }
                
                missingIndices.forEach(index => {
                  values[index] = '';
                });
              });
            }

            if (config.dataFormat === 'wide') {
              for (let i = 0; i < n; i++) {
                const row = { ParticipantID: participantIds[i] };
                config.variables.forEach(variable => {
                  row[variable.name] = variableData[variable.name][i];
                });
                data.push(row);
              }
            } else {
              for (let i = 0; i < n; i++) {
                config.variables.forEach(variable => {
                  data.push({
                    ParticipantID: participantIds[i],
                    Variable: variable.name,
                    Value: variableData[variable.name][i]
                  });
                });
              }
            }

            setGeneratedData(data);
            setShowPreview(true);
          };

          const exportCSV = () => {
            if (!generatedData) return;
            
            const headers = Object.keys(generatedData[0]);
            const csvContent = [
              headers.join(','),
              ...generatedData.map(row => 
                headers.map(header => {
                  const value = row[header];
                  return typeof value === 'string' && value.includes(',') ? `"${value}"` : value;
                }).join(',')
              )
            ].join('\n');

            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'psychology_dataset.csv';
            a.click();
            window.URL.revokeObjectURL(url);
          };

          const exportExcel = () => {
            if (!generatedData) return;
            
            const headers = Object.keys(generatedData[0]);
            const tsvContent = [
              headers.join('\t'),
              ...generatedData.map(row => 
                headers.map(header => row[header]).join('\t')
              )
            ].join('\n');

            const blob = new Blob([tsvContent], { type: 'text/tab-separated-values' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'psychology_dataset.xlsx';
            a.click();
            window.URL.revokeObjectURL(url);
          };

          const renderStep1 = () => (
            <div className="space-y-6">
              <div>
                <h2 className="text-xl font-semibold mb-4">Step 1: Describe Your Dataset</h2>
                <div className="space-y-4">
                  <div>
                    <label className="block text-sm font-medium mb-2">Dataset Description</label>
                    <textarea
                      value={config.description}
                      onChange={(e) => setConfig(prev => ({ ...prev, description: e.target.value }))}
                      placeholder="Describe the research scenario and what you want students to analyze..."
                      className="w-full p-3 border rounded-lg h-24 resize-none"
                    />
                  </div>
                  
                  <div>
                    <label className="block text-sm font-medium mb-2">Sample Size</label>
                    <input
                      type="number"
                      value={config.sampleSize}
                      onChange={(e) => setConfig(prev => ({ ...prev, sampleSize: parseInt(e.target.value) || 100 }))}
                      className="w-32 p-2 border rounded"
                      min="10"
                      max="10000"
                    />
                  </div>

                  <div>
                    <label className="block text-sm font-medium mb-2">Data Format</label>
                    <div className="space-y-2">
                      <label className="flex items-center">
                        <input
                          type="radio"
                          value="wide"
                          checked={config.dataFormat === 'wide'}
                          onChange={(e) => setConfig(prev => ({ ...prev, dataFormat: e.target.value }))}
                          className="mr-2"
                        />
                        Wide format (each variable as a column)
                      </label>
                      <label className="flex items-center">
                        <input
                          type="radio"
                          value="long"
                          checked={config.dataFormat === 'long'}
                          onChange={(e) => setConfig(prev => ({ ...prev, dataFormat: e.target.value }))}
                          className="mr-2"
                        />
                        Long format (repeated measures)
                      </label>
                    </div>
                  </div>

                  <div>
                    <label className="block text-sm font-medium mb-2">Target Analyses (select all that apply)</label>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-2 max-h-40 overflow-y-auto border p-3 rounded">
                      {analysisOptions.map(analysis => (
                        <label key={analysis} className="flex items-center text-sm">
                          <input
                            type="checkbox"
                            checked={config.targetAnalyses.includes(analysis)}
                            onChange={(e) => {
                              if (e.target.checked) {
                                setConfig(prev => ({ 
                                  ...prev, 
                                  targetAnalyses: [...prev.targetAnalyses, analysis]
                                }));
                              } else {
                                setConfig(prev => ({ 
                                  ...prev, 
                                  targetAnalyses: prev.targetAnalyses.filter(a => a !== analysis)
                                }));
                              }
                            }}
                            className="mr-2"
                          />
                          {analysis}
                        </label>
                      ))}
                    </div>
                  </div>
                </div>
              </div>
            </div>
          );

          const renderStep2 = () => (
            <div className="space-y-6">
              <div className="flex justify-between items-center">
                <h2 className="text-xl font-semibold">Step 2: Define Variables</h2>
                <button
                  onClick={addVariable}
                  className="flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"
                >
                  <Plus />
                  Add Variable
                </button>
              </div>

              <div className="space-y-4">
                {config.variables.map((variable, index) => (
                  <div key={variable.id} className="border rounded-lg p-4 bg-gray-50">
                    <div className="flex justify-between items-start mb-4">
                      <h3 className="font-medium">Variable {index + 1}</h3>
                      <button
                        onClick={() => removeVariable(variable.id)}
                        className="text-red-600 hover:text-red-800"
                      >
                        <Trash2 />
                      </button>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div>
                        <label className="block text-sm font-medium mb-1">Variable Name</label>
                        <input
                          type="text"
                          value={variable.name}
                          onChange={(e) => updateVariable(variable.id, { name: e.target.value })}
                          placeholder="e.g., Age, Anxiety_Score"
                          className="w-full p-2 border rounded"
                        />
                      </div>

                      <div>
                        <label className="block text-sm font-medium mb-1">Variable Type</label>
                        <select
                          value={variable.type}
                          onChange={(e) => updateVariable(variable.id, { type: e.target.value })}
                          className="w-full p-2 border rounded"
                        >
                          {variableTypes.map(type => (
                            <option key={type.value} value={type.value}>
                              {type.label}
                            </option>
                          ))}
                        </select>
                        <p className="text-xs text-gray-600 mt-1">
                          {variableTypes.find(t => t.value === variable.type)?.example}
                        </p>
                      </div>

                      {(variable.type === 'nominal' || variable.type === 'ordinal') && (
                        <div className="md:col-span-2">
                          <label className="block text-sm font-medium mb-1">Categories (comma-separated)</label>
                          <input
                            type="text"
                            value={variable.categoriesInput || variable.categories.join(', ')}
                            onChange={(e) => {
                              const input = e.target.value;
                              const newCategories = input.split(',')
                                .map(c => c.trim())
                                .filter(c => c.length > 0);
                              
                              updateVariable(variable.id, { 
                                categoriesInput: input,
                                categories: newCategories.length > 0 ? newCategories : ['Category 1']
                              });
                            }}
                            onBlur={(e) => {
                              const input = e.target.value;
                              const newCategories = input.split(',')
                                .map(c => c.trim())
                                .filter(c => c.length > 0);
                              
                              const finalCategories = newCategories.length > 0 ? newCategories : ['Category 1'];
                              updateVariable(variable.id, { 
                                categoriesInput: finalCategories.join(', '),
                                categories: finalCategories
                              });
                            }}
                            placeholder="Male, Female, Other"
                            className="w-full p-2 border rounded"
                          />
                          <p className="text-xs text-gray-600 mt-1">
                            Categories: {variable.categories.join(' | ')}
                          </p>
                        </div>
                      )}

                      {(variable.type === 'interval' || variable.type === 'ratio') && (
                        <>
                          <div>
                            <label className="block text-sm font-medium mb-1">Distribution</label>
                            <select
                              value={variable.distribution}
                              onChange={(e) => updateVariable(variable.id, { distribution: e.target.value })}
                              className="w-full p-2 border rounded"
                            >
                              {distributionTypes.map(dist => (
                                <option key={dist.value} value={dist.value}>
                                  {dist.label}
                                </option>
                              ))}
                            </select>
                          </div>

                          <div className="grid grid-cols-2 gap-2">
                            <div>
                              <label className="block text-sm font-medium mb-1">Mean</label>
                              <input
                                type="number"
                                value={variable.mean}
                                onChange={(e) => updateVariable(variable.id, { mean: parseFloat(e.target.value) || 0 })}
                                className="w-full p-2 border rounded"
                                step="0.1"
                              />
                            </div>
                            <div>
                              <label className="block text-sm font-medium mb-1">SD</label>
                              <input
                                type="number"
                                value={variable.sd}
                                onChange={(e) => updateVariable(variable.id, { sd: parseFloat(e.target.value) || 1 })}
                                className="w-full p-2 border rounded"
                                step="0.1"
                                min="0.1"
                              />
                            </div>
                          </div>

                          <div className="grid grid-cols-2 gap-2">
                            <div>
                              <label className="block text-sm font-medium mb-1">Min Value</label>
                              <input
                                type="number"
                                value={variable.min}
                                onChange={(e) => updateVariable(variable.id, { min: parseFloat(e.target.value) || 0 })}
                                className="w-full p-2 border rounded"
                                step="0.1"
                              />
                            </div>
                            <div>
                              <label className="block text-sm font-medium mb-1">Max Value</label>
                              <input
                                type="number"
                                value={variable.max}
                                onChange={(e) => updateVariable(variable.id, { max: parseFloat(e.target.value) || 100 })}
                                className="w-full p-2 border rounded"
                                step="0.1"
                              />
                            </div>
                          </div>

                          <div className="md:col-span-2">
                            <label className="block text-sm font-medium mb-1">Correlate with</label>
                            <select
                              value={variable.correlateWith || ''}
                              onChange={(e) => updateVariable(variable.id, { correlateWith: e.target.value || null })}
                              className="w-full p-2 border rounded"
                            >
                              <option value="">None</option>
                              {config.variables
                                .filter(v => v.id !== variable.id && v.name && (v.type === 'interval' || v.type === 'ratio'))
                                .map(v => (
                                  <option key={v.id} value={v.name}>{v.name}</option>
                                ))}
                            </select>
                            {variable.correlateWith && (
                              <div className="mt-2">
                                <label className="block text-sm font-medium mb-1">
                                  Correlation Strength ({variable.correlationStrength})
                                </label>
                                <input
                                  type="range"
                                  min="-0.9"
                                  max="0.9"
                                  step="0.1"
                                  value={variable.correlationStrength}
                                  onChange={(e) => updateVariable(variable.id, { 
                                    correlationStrength: parseFloat(e.target.value) 
                                  })}
                                  className="w-full"
                                />
                              </div>
                            )}
                          </div>
                        </>
                      )}
                    </div>
                  </div>
                ))}
              </div>
            </div>
          );

          const renderStep3 = () => (
            <div className="space-y-6">
              <h2 className="text-xl font-semibold">Step 3: Final Configuration</h2>
              
              <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                  <label className="block text-sm font-medium mb-2">
                    Missing Data Percentage
                  </label>
                  <input
                    type="range"
                    min="0"
                    max="20"
                    step="1"
                    value={config.missingDataPercent}
                    onChange={(e) => setConfig(prev => ({ 
                      ...prev, 
                      missingDataPercent: parseInt(e.target.value) 
                    }))}
                    className="w-full"
                  />
                  <p className="text-sm text-gray-600">{config.missingDataPercent}% missing data</p>
                </div>

                <div>
                  <label className="flex items-center">
                    <input
                      type="checkbox"
                      checked={config.includeOutliers}
                      onChange={(e) => setConfig(prev => ({ 
                        ...prev, 
                        includeOutliers: e.target.checked 
                      }))}
                      className="mr-2"
                    />
                    Include outliers (adds extreme values)
                  </label>
                </div>
              </div>

              <div className="bg-blue-50 p-4 rounded-lg">
                <h3 className="font-medium mb-2">Dataset Summary</h3>
                <ul className="text-sm space-y-1">
                  <li>• Sample size: {config.sampleSize} participants</li>
                  <li>• Format: {config.dataFormat} format</li>
                  <li>• Variables: {config.variables.length} defined</li>
                  <li>• Target analyses: {config.targetAnalyses.join(', ') || 'None specified'}</li>
                  <li>• Missing data: {config.missingDataPercent}%</li>
                </ul>
              </div>

              <div className="flex gap-4">
                <button
                  onClick={generateDataset}
                  disabled={config.variables.length === 0}
                  className="flex items-center gap-2 px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-gray-400"
                >
                  <RefreshCw />
                  Generate Dataset
                </button>
              </div>
            </div>
          );

          const renderPreview = () => {
            if (!generatedData) return null;

            const previewData = generatedData.slice(0, 10);
            const headers = Object.keys(generatedData[0]);

            return (
              <div className="mt-8 border-t pt-6">
                <div className="flex justify-between items-center mb-4">
                  <h3 className="text-lg font-semibold">Dataset Preview</h3>
                  <div className="flex gap-2">
                    <button
                      onClick={() => setShowPreview(!showPreview)}
                      className="flex items-center gap-2 px-3 py-2 border rounded-lg hover:bg-gray-50"
                    >
                      {showPreview ? <EyeOff /> : <Eye />}
                      {showPreview ? 'Hide' : 'Show'} Preview
                    </button>
                    <button
                      onClick={exportCSV}
                      className="flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"
                    >
                      <FileText />
                      Export CSV
                    </button>
                    <button
                      onClick={exportExcel}
                      className="flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700"
                    >
                      <FileSpreadsheet />
                      Export Excel
                    </button>
                  </div>
                </div>

                {showPreview && (
                  <div className="overflow-x-auto">
                    <table className="w-full border-collapse border border-gray-300 text-sm">
                      <thead>
                        <tr className="bg-gray-100">
                          {headers.map(header => (
                            <th key={header} className="border border-gray-300 px-3 py-2 text-left font-medium">
                              {header}
                            </th>
                          ))}
                        </tr>
                      </thead>
                      <tbody>
                        {previewData.map((row, index) => (
                          <tr key={index} className="hover:bg-gray-50">
                            {headers.map(header => (
                              <td key={header} className="border border-gray-300 px-3 py-2">
                                {row[header] === '' ? <span className="text-gray-400 italic">missing</span> : row[header]}
                              </td>
                            ))}
                          </tr>
                        ))}
                      </tbody>
                    </table>
                    <p className="text-sm text-gray-600 mt-2">
                      Showing first 10 rows of {generatedData.length} total rows
                    </p>
                  </div>
                )}
              </div>
            );
          };

          return (
            <div className="max-w-4xl mx-auto p-6 bg-white min-h-screen">
              <div className="mb-8">
                <h1 className="text-2xl font-bold text-gray-800 mb-2">
                  Psychology Dataset Generator
                </h1>
                <p className="text-gray-600">
                  Create realistic fictional datasets for statistics and research methods courses
                </p>
              </div>

              <div className="flex mb-8 border-b">
                {[1, 2, 3].map(stepNum => (
                  <button
                    key={stepNum}
                    onClick={() => setStep(stepNum)}
                    className={`px-4 py-2 border-b-2 font-medium ${
                      step === stepNum 
                        ? 'border-blue-600 text-blue-600' 
                        : 'border-transparent text-gray-500 hover:text-gray-700'
                    }`}
                  >
                    Step {stepNum}
                  </button>
                ))}
              </div>

              {step === 1 && renderStep1()}
              {step === 2 && renderStep2()}
              {step === 3 && renderStep3()}

              <div className="flex justify-between mt-8">
                <button
                  onClick={() => setStep(Math.max(1, step - 1))}
                  disabled={step === 1}
                  className="px-4 py-2 border rounded-lg disabled:opacity-50 hover:bg-gray-50"
                >
                  Previous
                </button>
                <button
                  onClick={() => setStep(Math.min(3, step + 1))}
                  disabled={step === 3}
                  className="px-4 py-2 bg-blue-600 text-white rounded-lg disabled:opacity-50 hover:bg-blue-700"
                >
                  Next
                </button>
              </div>

              {renderPreview()}
            </div>
          );
        };

        ReactDOM.render(<PsychologyDatasetGenerator />, document.getElementById('root'));
    </script>
</body>
</html>
